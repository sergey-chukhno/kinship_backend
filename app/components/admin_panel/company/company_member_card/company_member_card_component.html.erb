<div class="admin-panel__member__card" id=<%= dom_id(@company_member) %>>
  <div class="admin-panel__member__card__info">

    <h3 class="s-paragraph-bold dark-01"><%= @member.full_name %></h3>

    <%= render Common::Tag::TagComponent.new(color: helpers.color_for_user_role(@member.role)) do %>
      <%= t(".roles.#{@member.role}") %>
    <% end %>

    <%= simple_form_for @company_member,
                      url: company_admin_panel_company_members_update_role_path(@company_member),
                      method: :put,
                      data: {
                        controller: "submit",
                        submit_target: "form"
                      },
                      html: {
                        class: "",
                        id: "#{dom_id(@company_member)}_update_role",
                      } do |f| %>

      <%= f.input :role,
                as: :select,
                label: false,
                include_blank: false,
                collection: [
                  ["Membre", "member"],
                  ["Intervenant", "intervenant"],
                  ["Référent", "referent"],
                  ["Admin", "admin"],
                  ["Superadmin", "superadmin"]
                ],
                input_html: {
                  class: "mini-select",
                  disabled: @company_member.superadmin? || @company_member.pending?,
                  data: {
                    action: "change->submit#submit"
                  }
                } %>
    <% end %>
  </div>

  <div class="admin-panel__member__card__actions">
    <% if contracted? %>
      <div class="permissions-info">
        <span><strong>Badges:</strong> <%= @company_member.can_assign_badges? ? "✓" : "✗" %></span>
        <span><strong>Projets:</strong> <%= @company_member.can_manage_projects? ? "✓" : "✗" %></span>
      </div>
    <% end %>

    <%= simple_form_for @company_member,
                      url: company_admin_panel_company_members_update_confirmation_path(@company_member),
                      method: :put,
                      data: {
                        controller: "submit",
                        submit_target: "form"
                      },
                      html: {
                        class: "",
                        id: "#{dom_id(@company_member)}_update_confirmation",
                      } do |f| %>
      <%= f.input :status,
                as: :boolean,
                wrapper: :switch,
                required: false,
                label: "Rattaché",
                label_html: {
                  for: "#{dom_id(@company_member)}_status"
                },
                input_html: {
                  id: "#{dom_id(@company_member)}_status",
                  checked: @company_member.confirmed?,
                  disabled: @company_member.superadmin?,
                  data: {
                    action: "change->submit#submit"
                  }
                } %>
    <% end %>

    <%= button_to company_admin_panel_company_member_path(@company_member),
                method: :delete,
                class: "btn-trash grey-02",
                disabled: @company_member.superadmin?,
                form_class: "admin-panel__member__card__delete" do %>
      <%= helpers.show_svg "trash.svg" %>
    <% end %>

  </div>

</div>
