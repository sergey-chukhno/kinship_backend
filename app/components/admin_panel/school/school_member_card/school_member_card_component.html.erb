<div class="admin-panel__member__card" id=<%= dom_id(@school_member) %>>
  <div class="admin-panel__member__card__info">

    <h3 class="s-paragraph-bold dark-01"><%= @member.full_name %></h3>

    <%= render Common::Tag::TagComponent.new(color: helpers.color_for_user_role(@member.role)) do %>
      <%= t(".roles.#{@member.role}") %>
    <% end %>

    <%= simple_form_for @school_member,
                      url: school_admin_panel_school_members_update_role_path(@school_member),
                      method: :put,
                      data: {
                        controller: "submit",
                        submit_target: "form"
                      },
                      html: {
                        class: "",
                        id: "#{dom_id(@school_member)}_update_role",
                      } do |f| %>

      <%= f.input :role,
                as: :select,
                label: false,
                include_blank: false,
                collection: [
                  ["Membre", "member"],
                  ["Intervenant", "intervenant"],
                  ["Référent", "referent"],
                  ["Admin", "admin"],
                  ["Superadmin", "superadmin"]
                ],
                input_html: {
                  class: "mini-select",
                  disabled: @school_member.superadmin? || @school_member.pending?,
                  data: {
                    action: "change->submit#submit"
                  }
                } %>
    <% end %>

    <%= render "school_level_form", school_member: @school_member %>

  </div>

  <div class="admin-panel__member__card__actions">
    <div class="permissions-info">
      <span><strong>Badges:</strong> <%= @school_member.can_assign_badges? ? "✓" : "✗" %></span>
      <span><strong>Projets:</strong> <%= @school_member.can_manage_projects? ? "✓" : "✗" %></span>
    </div>

    <%= simple_form_for @school_member,
                      url: school_admin_panel_school_members_update_confirmation_path(@school_member),
                      method: :put,
                      data: {
                        controller: "submit",
                        submit_target: "form"
                      },
                      html: {
                        class: "",
                        id: "#{dom_id(@school_member)}_update_confirmation",
                      } do |f| %>
      <%= f.input :status,
                as: :boolean,
                wrapper: :switch,
                required: false,
                label: "Rattaché",
                label_html: {
                  for: "#{dom_id(@school_member)}_confirmation"
                },
                input_html: {
                  id: "#{dom_id(@school_member)}_confirmation",
                  checked: @school_member.confirmed?,
                  disabled: @school_member.superadmin?,
                  data: {
                    action: "change->submit#submit"
                  }
                } %>
    <% end %>

    <%= button_to school_admin_panel_school_member_path(@school_member),
                method: :delete,
                class: "btn-trash grey-02",
                disabled: @school_member.superadmin?,
                form_class: "admin-panel__member__card__delete" do %>
      <%= helpers.show_svg "trash.svg" %>
    <% end %>

  </div>

</div>
